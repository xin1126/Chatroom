import{h as e,e as a,w as t,i as s,o as n,b as l,f as r,t as o,g as i,m as c,F as u,j as g,k as d,n as m,p as b}from"./vendor.da7949e7.js";import{n as v,d as p,v as f,w as y,x,y as h,z as k}from"./role.ecb8d499.js";import{f as w,g as j,r as O,a as R,b as C,w as P}from"./firebaseData.d708bc2c.js";const V={setup(){const n=e(),l=a([]),r=a([]),o=a(""),i=a(""),c=a(""),u=a(!1),g=a(!1),d=a(!1);let m,b;return t(P,(()=>{1===P.value&&n.push(`/${b}`)})),s((()=>{v.value?(p.ref("publicRoom").on("value",(e=>{e.val()?1!==Object.entries(e.val()).pop()[1]&&(l.value=Object.entries(e.val()).map((e=>({[e[0]]:Object.keys(Object.values(e[1])[0]).join("")})))):l.value=[]})),p.ref("privateRoom").on("value",(e=>{e.val()&&(r.value=Object.entries(e.val()).map((e=>Object.keys(e[1])[0])),m=Object.values(e.val()))}))):n.push("/")})),{router:n,data:l,chatroom:()=>{c.value=1,setTimeout((()=>{w.value=!0,j(),b="room"}),1500)},enterRoom:(e,a)=>{a<0?(c.value=e,setTimeout((()=>{O.value=e,w.value=!0,R(),b=`room/${e}`}),1500)):o.value=e,d.value=!1,i.value=""},searchView:u,searchClosure:e=>{"DIV"!==e.target.nodeName&&"I"!==e.target.nodeName||(u.value=!1,o.value="")},privateView:g,password:f,privateRoom:r,change:o,createPublicRoom:()=>{c.value=3,setTimeout((()=>{w.value=!0,C("wss://vast-hollows-31339.herokuapp.com/",!1),b="room"}),1500)},createPrivateRoom:()=>{c.value=2,setTimeout((()=>{w.value=!0,C("wss://vast-hollows-31339.herokuapp.com/",!0),b="room"}),1500)},enterPrivateRoom:e=>{m.forEach((a=>{Object.keys(a).join("")===e&&(Object.values(a).join("")===i.value?(d.value=!1,c.value=e,setTimeout((()=>{O.value=e,w.value=!0,R(),b=`room/${e}`}),1500)):d.value=!0)}))},privatePassword:i,warn:d,loading:c}}},T={class:"flex flex-col items-center sm:mt-20 mt-10 mx-3"},$={class:"flex mb-10"},D={class:"flex flex-col items-center sm:mr-24 mr-6"},I=r("img",{class:"max-w-28 h-32 mb-2",src:y,alt:""},null,-1),N={key:1,class:"fas fa-spinner fa-spin fa-2x mt-3"},U={class:"flex flex-col items-center mr-3"},z=r("img",{class:"w-28 h-32 mb-2",src:x,alt:""},null,-1),E={class:"text-white dark:text-black"},F={class:"bg-gray-600 rounded-lg px-3 pt-3"},q=r("li",{class:"\n              flex\n              items-center\n              justify-between\n              border-bottom border-gray-900\n              pb-2\n              text-white\n            "},[r("span",{class:"text-gray-600"},"1"),r("span",{class:"text-lg"},"搜尋房間"),r("i",{class:"fas fa-times cursor-pointer hover:text-gray-800"})],-1),A={key:0,class:"ml-10"},B={key:0,class:"fas fa-lock mr-2"},G={key:2,class:"fas fa-spinner fa-spin fa-2x mt-3"},H={key:1,class:"ml-4"},J={key:0,class:"flex justify-end mb-1"},K={key:1,class:"fas fa-spinner fa-spin fa-2x mt-3"},L={class:"text-red-500"},M=r("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),Q=m("密碼錯誤 "),S={class:"flex"},W={class:"flex flex-col items-center sm:mr-16 mr-4"},X=r("img",{class:"max-w-40 h-32 mb-2",src:h,alt:""},null,-1),Y={key:1,class:"fas fa-spinner fa-spin fa-2x mt-3"},Z={class:"flex flex-col items-center"},_=r("img",{class:"max-w-28 h-32 mb-2",src:k,alt:""},null,-1),ee={class:"\n          absolute\n          top-0\n          left-0\n          w-full\n          h-full\n          flex\n          justify-center\n          items-center\n          bg-white/25\n        "},ae={class:"bg-gray-700 p-3 rounded-lg text-center"},te=r("label",{for:"password",class:"mb-1 text-white block"},[r("i",{class:"fas fa-lock mr-1"}),m("設定房間密碼")],-1),se={key:1,class:"fas fa-spinner fa-spin fa-2x"};V.render=function(e,a,t,s,v,p){return n(),l("div",T,[r("div",$,[r("div",D,[I,1!==s.loading?(n(),l("button",{key:0,type:"button",class:"\n            text-lg\n            sm:text-2xl\n            bg-gray-700\n            dark:bg-gray-500\n            dark:hover:bg-gray-600\n            hover:bg-gray-900\n            text-white\n            rounded-lg\n            p-2\n          ",onClick:a[1]||(a[1]=(...e)=>s.chatroom&&s.chatroom(...e))}," 公開頻道 ")):(n(),l("i",N))]),r("div",U,[z,r("button",{type:"button",class:["\n            text-lg\n            sm:text-2xl\n            bg-gray-700\n            dark:bg-gray-500\n            dark:hover:bg-gray-600\n            text-white\n            rounded-lg\n            p-2\n            mb-2\n          ",s.data.length?"hover:bg-gray-900":["disabled:opacity-50","cursor-default"]],disabled:!s.data.length,onClick:a[2]||(a[2]=e=>s.searchView=!0)}," 搜尋房間 ",10,["disabled"]),r("div",E,o(s.data.length?`(目前共有${s.data.length}間)`:"(目前無人建立房間)"),1)]),i(r("div",{class:"\n          absolute\n          top-0\n          left-0\n          w-full\n          h-full\n          flex\n          justify-center\n          items-center\n          bg-white/25\n        ",onClick:a[4]||(a[4]=(...e)=>s.searchClosure&&s.searchClosure(...e))},[r("ul",F,[q,(n(!0),l(u,null,g(s.data,(e=>(n(),l("li",{class:"flex justify-between items-center mb-3 text-white",key:e},[m(" 房主："+o(Object.values(e).join(""))+" ",1),s.change!==Object.keys(e).join("")?(n(),l("div",A,[s.privateRoom.indexOf(Object.keys(e).join(""))>=0?(n(),l("i",B)):b("",!0),s.loading!==Object.keys(e).join("")?(n(),l("button",{key:1,class:"\n                  text-sm\n                  bg-gray-700\n                  hover:bg-gray-900\n                  text-white\n                  rounded-lg\n                  p-2\n                ",onClick:a=>s.enterRoom(Object.keys(e).join(""),s.privateRoom.indexOf(Object.keys(e).join("")))}," 進入房間 ",8,["onClick"])):(n(),l("i",G))])):(n(),l("div",H,[s.loading!==Object.keys(e).join("")?(n(),l("div",J,[i(r("input",{class:"pl-2 rounded-l-lg text-black w-3/4",type:"text",placeholder:"請輸入密碼","onUpdate:modelValue":a[3]||(a[3]=e=>s.privatePassword=e)},null,512),[[d,s.privatePassword]]),r("button",{class:"\n                    text-sm\n                    bg-gray-700\n                    hover:bg-gray-900\n                    text-white\n                    rounded-r-lg\n                    p-2\n                  ",onClick:a=>s.enterPrivateRoom(Object.keys(e).join(""))}," 確認 ",8,["onClick"])])):(n(),l("i",K)),i(r("p",L,[M,Q],512),[[c,s.warn]])]))])))),128))])],512),[[c,s.searchView]])]),r("div",S,[r("div",W,[X,3!==s.loading?(n(),l("button",{key:0,type:"button",class:"\n            text-lg\n            sm:text-2xl\n            bg-gray-700\n            dark:bg-gray-500\n            dark:hover:bg-gray-600\n            hover:bg-gray-900\n            text-white\n            rounded-lg\n            p-2\n          ",onClick:a[5]||(a[5]=(...e)=>s.createPublicRoom&&s.createPublicRoom(...e))}," 建立公開房間 ")):(n(),l("i",Y))]),r("div",Z,[_,r("button",{type:"button",class:"\n            text-lg\n            sm:text-2xl\n            bg-gray-700\n            dark:bg-gray-500\n            dark:hover:bg-gray-600\n            hover:bg-gray-900\n            text-white\n            rounded-lg\n            p-2\n          ",onClick:a[6]||(a[6]=e=>s.privateView=!0)}," 建立私人房間 ")]),i(r("div",ee,[r("div",ae,[te,i(r("input",{class:"mb-2 pl-2 rounded",type:"text",id:"password",placeholder:"請輸入密碼","onUpdate:modelValue":a[7]||(a[7]=e=>s.password=e)},null,512),[[d,s.password]]),r("div",null,[r("button",{class:"\n                bg-gray-900\n                dark:bg-gray-500\n                dark:hover:bg-gray-600\n                hover:bg-gray-800\n                text-white\n                rounded-lg\n                px-2\n                mr-2\n              ",onClick:a[8]||(a[8]=e=>s.privateView=!1)}," 取消 "),2!==s.loading?(n(),l("button",{key:0,class:"\n                bg-gray-900\n                dark:bg-gray-500\n                dark:hover:bg-gray-600\n                hover:bg-gray-800\n                text-white\n                rounded-lg\n                px-2\n              ",onClick:a[9]||(a[9]=(...e)=>s.createPrivateRoom&&s.createPrivateRoom(...e))}," 建立房間 ")):(n(),l("i",se))])])],512),[[c,s.privateView]])])])};export default V;
