import{e,j as t,w as a,k as l,o as n,b as s,g as r,F as o,l as u,h as c,m as i,n as d,q as g,t as v,s as p}from"./vendor.3e530e47.js";import{n as x,p as b,c as m,i as y}from"./role.143e5a62.js";const f={setup(){const n=e(""),s=e(""),r=e(""),o=e(""),u=e(""),c=e(""),i=e("請輸入留言"),d=e(!1),g=t(),v=e(JSON.parse(localStorage.getItem(x.value))||[]);return a(n,(()=>{setTimeout((()=>{var e;c.value.scrollTop=(null==(e=c.value)?void 0:e.scrollHeight)+2e3}),450)})),l((()=>{x.value?(u.value=window.innerHeight,b.on("value",(e=>{n.value=Object.entries(e.val())}))):g.push("/")})),{name:x,data:n,str:i,height:u,addData:()=>{if(""!==s.value){const e={};e[x.value]={img:y.value,content:s.value,date:(new Date).getTime(),edit:!1},s.value="",b.push().set(e);const t=[...n.value].pop()[0];v.value.push(t),localStorage.setItem(x.value,JSON.stringify(v.value))}else i.value="請輸入留言"===i.value?"尚未輸入留言":"請輸入留言"},message:s,tempId:v,editData:(e,t,a)=>{if(a)r.value=""!==r.value?"":e,o.value=""!==o.value?"":t,d.value=!1;else{if(d.value=!0,t===o.value||""===o.value)return;const a={};a[x.value]={img:y.value,content:o.value,date:(new Date).getTime(),edit:!0},b.child(e).set(a),r.value="",o.value=""}},editInput:r,editMessage:o,removeMessage:e=>{const t={};t[x.value]={content:""},b.child(e).set(t)},verify:d,checked:m,scroll:c}}},h={class:"\n      flex\n      justify-center\n      items-center\n      flex-col\n      bg-gray-500\n      dark:bg-gray-200\n      p-3\n    "},k={class:"message"},w={key:0,class:"flex break-all mb-8"},j={class:"ml-1"},O={class:"text-white dark:text-gray-500 mb-1 relative"},D={class:"absolute w-52 bottom-1 ml-2 text-gray-400 text-xs"},I={class:"\n                  relative\n                  bg-gray-500\n                  text-white text-lg\n                  px-3\n                  py-1\n                  ml-2\n                  rounded-lg\n                "},M=r("i",{class:"fas fa-2x fa-caret-left absolute text-gray-500"},null,-1),C={key:1,class:"text-right break-all mb-8"},S={class:"mr-2 text-gray-400 text-xs"},T={key:0,class:"\n                inline-block\n                relative\n                bg-blue-900\n                text-white text-lg\n                px-3\n                py-1\n                mb-2\n                rounded-lg\n              "},H=r("i",{class:"fas fa-2x fa-caret-right absolute text-blue-900"},null,-1),J={class:"text-sm text-red-500 mb-2"},L={class:"fas fa-exclamation-triangle"},N={class:"flex justify-end"},U={key:2,class:"text-center mb-6"},V={class:"bg-gray-400 px-2 py-1 text-sm text-gray-100 rounded-lg"},q={class:"\n        flex\n        justify-center\n        max-w-[500px]\n        w-full\n        bg-gray-800\n        dark:bg-gray-300\n        dark:shadow-lg\n        p-5\n        rounded-b-lg\n      "},F=r("i",{class:"far fa-paper-plane text-xl"},null,-1);f.render=function(e,t,a,l,x,b){return n(),s("div",h,[r("div",{ref:"scroll",class:["\n        max-w-[500px] max-h-[750px]\n        scroll\n        overflow-y-auto overflow-x-hidden\n        w-full\n        bg-gray-700\n        dark:bg-white\n        rounded-t-lg\n        p-4\n      ",l.checked?["scroll-track","scroll-thumb"]:"scroll"],style:{height:l.height-180+"px"}},[r("ul",k,[(n(!0),s(o,null,u(l.data,(e=>(n(),s(o,{key:e[0]},[l.tempId.indexOf(e[0])<0&&""!==Object.values(e[1])[0].content?(n(),s("li",w,[r("img",{class:"w-[40px] h-[50px]",src:Object.values(e[1])[0].img,alt:"avatar"},null,8,["src"]),r("div",j,[r("div",O,[g(v(Object.keys(e[1]).join(""))+" ",1),r("span",D,v(new Date(Object.values(e[1])[0].date).toLocaleString())+v(Object.values(e[1])[0].edit?"(已編輯)":""),1)]),r("div",I,[M,g(" "+v(Object.values(e[1])[0].content),1)])])])):l.tempId.indexOf(e[0])>=0&&""!==Object.values(e[1])[0].content?(n(),s("li",C,[r("span",S,v(new Date(Object.values(e[1])[0].date).toLocaleString())+v(Object.values(e[1])[0].edit?"(已編輯)":""),1),l.editInput!==e[0]?(n(),s("div",T,[H,g(" "+v(Object.values(e[1])[0].content),1)])):c((n(),s("input",{key:1,type:"text",class:"\n                mb-2\n                py-1\n                pl-2\n                rounded-lg\n                dark:border-2 dark:border-gray-500\n              ","onUpdate:modelValue":t[1]||(t[1]=e=>l.editMessage=e)},null,512)),[[i,l.editMessage]]),c(r("div",J,[c(r("i",L,null,512),[[p,""===l.editMessage||l.editMessage===Object.values(e[1])[0].content]]),g(" "+v(l.editMessage===Object.values(e[1])[0].content?"尚未編輯新留言":""===l.editMessage?"編輯留言不可為空":""),1)],512),[[p,l.verify&&l.editInput===e[0]]]),r("div",N,[r("button",{class:"\n                  bg-gray-500\n                  hover:bg-gray-800\n                  text-white text-sm\n                  flex\n                  rounded-lg\n                  px-2\n                  py-1\n                  mr-3\n                ",onClick:t=>l.editData(e[0],Object.values(e[1])[0].content,!0)},v(l.editInput!==e[0]?"編輯":"取消"),9,["onClick"]),l.editInput!==e[0]?(n(),s("button",{key:0,class:"\n                  bg-gray-500\n                  hover:bg-gray-800\n                  text-white text-sm\n                  rounded-lg\n                  px-2\n                  py-1\n                ",onClick:t=>l.removeMessage(e[0])}," 收回 ",8,["onClick"])):(n(),s("button",{key:1,class:"\n                  bg-green-600\n                  hover:bg-green-900\n                  text-white text-sm\n                  rounded-lg\n                  px-2\n                  py-1\n                ",onClick:t=>l.editData(e[0],Object.values(e[1])[0].content,!1)}," 確認 ",8,["onClick"]))])])):(n(),s("li",U,[r("span",V,v(Object.keys(e[1]).join(""))+"已收回訊息",1)]))],64)))),128))])],6),r("div",q,[c(r("input",{type:"text",placeholder:l.str,"onUpdate:modelValue":t[2]||(t[2]=e=>l.message=e),onKeydown:t[3]||(t[3]=d((e=>l.addData()),["enter"])),class:"rounded-l-lg p-2 w-full"},null,40,["placeholder"]),[[i,l.message]]),r("button",{onClick:t[4]||(t[4]=(...e)=>l.addData&&l.addData(...e)),class:"bg-gray-500 hover:bg-gray-700 text-white rounded-r-lg px-3 py-1"},[F])])])};export default f;
