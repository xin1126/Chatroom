import{o as e,d as t,c as a,e as n,r as l}from"./firebaseData.d708bc2c.js";import{o as s,b as r,f as c,t as o,F as i,j as u,n as d,e as g,w as v,s as b,i as p,g as x,k as m,l as h,m as y}from"./vendor.da7949e7.js";import{c as f,A as k,n as w,i as j,d as O}from"./role.ecb8d499.js";const D={setup:()=>({onLine:e})},L={class:"\n      w-[180px]\n      h-onLine\n      mt-3\n      bg-gray-700\n      dark:bg-white\n      dark:shadow-md\n      rounded-lg\n      hidden\n      md:block\n    "},I={class:"text-center mt-3 text-white dark:text-gray-600"},M={class:"pl-3"},C=c("div",{class:"w-[12px] h-[12px] bg-green-500 rounded-full ml-auto mr-3"},null,-1);D.render=function(e,t,a,n,l,g){return s(),r("div",L,[c("p",I," 線上人數："+o(Object.values(n.onLine).length),1),c("ul",M,[(s(!0),r(i,null,u(n.onLine,(e=>(s(),r("li",{class:"flex items-center mb-2 text-white dark:text-gray-600",key:e},[c("img",{class:"w-[30px] h-[40px] mr-1",src:Object.values(e).join(""),alt:""},null,8,["src"]),d(" "+o(Object.keys(e).join(""))+" ",1),C])))),128))])])};const H={setup(){const t=g(!0);return{onLine:e,onLineHeight:t}}},R={class:"\n      md:hidden\n      w-full\n      sm:w-[500px]\n      flex\n      justify-between\n      bg-gray-800\n      dark:bg-gray-300\n      rounded-t-lg\n      px-3\n      py-2\n    "},T={class:"text-white dark:text-gray-600"},S={class:"pl-3 pt-2"},K={class:"pr-2"},U=c("div",{class:"w-[12px] h-[12px] bg-green-500 rounded-full mr-3 ml-auto"},null,-1);H.render=function(e,t,a,n,l,d){return s(),r("div",R,[c("p",T," 線上人數："+o(Object.values(n.onLine).length),1),c("button",{type:"button",class:"\n        bg-gray-500\n        hover:bg-gray-600\n        text-white text-sm\n        flex\n        rounded-lg\n        px-2\n        py-1\n      ",onClick:t[1]||(t[1]=e=>n.onLineHeight=!n.onLineHeight)}," 查看線上用戶 "),c("div",{class:["\n        absolute\n        right-6\n        top-16\n        bg-gray-500\n        rounded-lg\n        z-10\n        overflow-hidden\n      ",{"h-0":n.onLineHeight}]},[c("ul",S,[(s(!0),r(i,null,u(n.onLine,(e=>(s(),r("li",{class:"flex items-center mb-2 text-white dark:text-gray-600",key:e},[c("img",{class:"w-[30px] h-[40px] mr-1",src:Object.values(e).join(""),alt:""},null,8,["src"]),c("p",K,o(Object.keys(e).join("")),1),U])))),128))])],2)])};const V={setup(){const e=g(""),s=g(""),r=g(""),c=g(!1);return v(t,(async()=>{await b(),setTimeout((()=>{r.value.scrollTop=r.value.scrollHeight+2e3}),500)})),p((()=>{r.value.scrollTop=r.value.scrollHeight})),{data:t,checked:f,tempId:k,verify:c,scroll:r,editInput:e,editMessage:s,editData:(t,r,o)=>{if(o)e.value=""!==e.value?"":t,s.value=""!==s.value?"":r,c.value=!1;else{if(c.value=!0,r===s.value||""===s.value)return;const o={};o[w.value]={img:j.value,content:s.value,date:(new Date).getTime(),edit:!0},a.value.url.indexOf("fierce-savannah")>=0?O.ref("chatroom").child(t).set(o):a.value.url.indexOf("vast-hollows")>=0?O.ref("publicRoom").child(n.value).child(t).set(o):O.ref("publicRoom").child(l.value).child(t).set(o),e.value="",s.value=""}},removeMessage:e=>{const t={};t[w.value]={content:""},a.value.url.indexOf("fierce-savannah")>=0?O.ref("chatroom").child(e).set(t):a.value.url.indexOf("vast-hollows")>=0?O.ref("publicRoom").child(n.value).child(e).set(t):O.ref("publicRoom").child(l.value).child(e).set(t)}}}},z={class:"message"},A={key:0,class:"flex break-all mb-8"},F={class:"ml-1"},J={class:"text-white dark:text-gray-500 mb-1 relative"},N={class:"absolute w-52 bottom-1 ml-2 text-gray-400 text-xs"},_={class:"\n                relative\n                bg-gray-500\n                text-white text-lg\n                px-3\n                py-1\n                ml-2\n                rounded-lg\n              "},q=c("i",{class:"fas fa-2x fa-caret-left absolute text-gray-500"},null,-1),B={key:1,class:"text-right break-all mb-8"},E={class:"mr-2 text-gray-400 text-xs"},G={key:0,class:"\n              inline-block\n              relative\n              bg-blue-900\n              text-white text-lg\n              px-3\n              py-1\n              mb-2\n              rounded-lg\n            "},P=c("i",{class:"fas fa-2x fa-caret-right absolute text-blue-900"},null,-1),Q={class:"text-sm text-red-500 mb-2"},W={class:"fas fa-exclamation-triangle"},X={class:"flex justify-end"},Y={key:2,class:"text-center mb-6"},Z={class:"bg-gray-400 px-2 py-1 text-sm text-gray-100 rounded-lg"},$={key:3,class:"text-center mb-6"},ee={class:"bg-gray-400 px-2 py-1 text-sm text-gray-100 rounded-lg"},te={key:4,class:"text-center mb-6"},ae={class:"bg-gray-400 px-2 py-1 text-sm text-gray-100 rounded-lg"};V.render=function(e,t,a,n,l,g){return s(),r("div",{ref:"scroll",class:["\n      w-full\n      sm:w-[500px]\n      h-chatroom\n      scroll\n      overflow-y-auto overflow-x-hidden\n      bg-gray-700\n      dark:bg-white\n      md:rounded-t-lg\n      p-4\n    ",n.checked?["scroll-track","scroll-thumb"]:"scroll"]},[c("ul",z,[(s(!0),r(i,null,u(n.data,(e=>(s(),r(i,{key:e[0]},[n.tempId.indexOf(e[0])<0&&""!==Object.values(e[1])[0].content?(s(),r("li",A,[c("img",{class:"w-[40px] h-[50px]",src:Object.values(e[1])[0].img,alt:"avatar"},null,8,["src"]),c("div",F,[c("div",J,[d(o(Object.keys(e[1]).join(""))+" ",1),c("span",N,o(new Date(Object.values(e[1])[0].date).toLocaleString())+o(Object.values(e[1])[0].edit?"(已編輯)":""),1)]),c("div",_,[q,d(" "+o(Object.values(e[1])[0].content),1)])])])):n.tempId.indexOf(e[0])>=0&&""!==Object.values(e[1])[0].content?(s(),r("li",B,[c("span",E,o(new Date(Object.values(e[1])[0].date).toLocaleString())+o(Object.values(e[1])[0].edit?"(已編輯)":""),1),n.editInput!==e[0]?(s(),r("div",G,[P,d(" "+o(Object.values(e[1])[0].content),1)])):x((s(),r("input",{key:1,type:"text",class:"mb-2 py-1 pl-2 rounded-lg dark:border-2 dark:border-gray-500","onUpdate:modelValue":t[1]||(t[1]=e=>n.editMessage=e),onKeydown:h((t=>n.editData(e[0],Object.values(e[1])[0].content,!1)),["enter"])},null,40,["onKeydown"])),[[m,n.editMessage]]),x(c("div",Q,[x(c("i",W,null,512),[[y,""===n.editMessage||n.editMessage===Object.values(e[1])[0].content]]),d(" "+o(n.editMessage===Object.values(e[1])[0].content?"尚未編輯新留言":""===n.editMessage?"編輯留言不可為空":""),1)],512),[[y,n.verify&&n.editInput===e[0]]]),c("div",X,[c("button",{class:"\n                bg-gray-500\n                hover:bg-gray-800\n                text-white text-sm\n                flex\n                rounded-lg\n                px-2\n                py-1\n                mr-3\n              ",onClick:t=>n.editData(e[0],Object.values(e[1])[0].content,!0)},o(n.editInput!==e[0]?"編輯":"取消"),9,["onClick"]),n.editInput!==e[0]?(s(),r("button",{key:0,class:"\n                bg-gray-500\n                hover:bg-gray-800\n                text-white text-sm\n                rounded-lg\n                px-2\n                py-1\n              ",onClick:t=>n.removeMessage(e[0])}," 收回 ",8,["onClick"])):(s(),r("button",{key:1,class:"\n                bg-green-600\n                hover:bg-green-900\n                text-white text-sm\n                rounded-lg\n                px-2\n                py-1\n              ",onClick:t=>n.editData(e[0],Object.values(e[1])[0].content,!1)}," 確認 ",8,["onClick"]))])])):""===Object.values(e[1])[0].content&&Object.values(e[1])[0].status?(s(),r("li",Y,[c("span",Z,o(Object.keys(e[1]).join(""))+"加入聊天室",1)])):""===Object.values(e[1])[0].content&&!1===Object.values(e[1])[0].status?(s(),r("li",$,[c("span",ee,o(Object.keys(e[1]).join(""))+"離開聊天室",1)])):(s(),r("li",te,[c("span",ae,o(Object.keys(e[1]).join(""))+"已收回訊息",1)]))],64)))),128))])],2)};const ne={setup(){const e=g("請輸入留言"),s=g("");return{name:w,data:t,str:e,tempId:k,message:s,addData:()=>{if(""!==s.value){const e={};e[w.value]={img:j.value,content:s.value,date:(new Date).getTime(),edit:!1},s.value="",a.value.url.indexOf("fierce-savannah")>=0?O.ref("chatroom").push().set(e):a.value.url.indexOf("vast-hollows")>=0?O.ref("publicRoom").child(n.value).push().set(e):O.ref("publicRoom").child(l.value).push().set(e);const r=[...t.value].pop()[0];k.value.push(r),localStorage.setItem(w.value,JSON.stringify(k.value))}else e.value="請輸入留言"===e.value?"尚未輸入留言":"請輸入留言"}}}},le={class:"\n      flex\n      justify-center\n      max-w-[500px]\n      w-full\n      bg-gray-800\n      dark:bg-gray-300\n      dark:shadow-lg\n      p-5\n      rounded-b-lg\n    "},se=c("i",{class:"far fa-paper-plane text-xl"},null,-1);ne.render=function(e,t,a,n,l,o){return s(),r("div",le,[x(c("input",{type:"text",placeholder:n.str,"onUpdate:modelValue":t[1]||(t[1]=e=>n.message=e),onKeydown:t[2]||(t[2]=h((e=>n.addData()),["enter"])),class:"rounded-l-lg p-2 w-full"},null,40,["placeholder"]),[[m,n.message]]),c("button",{onClick:t[3]||(t[3]=(...e)=>n.addData&&n.addData(...e)),class:"bg-gray-500 hover:bg-gray-700 text-white rounded-r-lg px-3 py-1"},[se])])};export{D as _,H as a,V as b,ne as c};
